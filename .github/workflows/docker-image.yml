- name: Pull ARM64 Images
        run: |
          # 核心服务 (指定 arm64 架构)
          docker pull --platform linux/arm64 langgenius/dify-api:1.11.4
          docker pull --platform linux/arm64 langgenius/dify-web:1.11.4
          docker pull --platform linux/arm64 langgenius/dify-sandbox:0.2.12
          
          # 修正后的插件守护进程镜像：通常是 0.0.1 或者使用最新稳定版
          # 针对 1.11.4，我们尝试拉取 0.0.1，如果你的 YAML 里写的是 0.5.2-local，
          # 离线导入后我们可以用 docker tag 改名对齐。
          docker pull --platform linux/arm64 langgenius/dify-plugin-daemon:0.0.1
          
          # 基础组件
          docker pull --platform linux/arm64 postgres:15-alpine
          docker pull --platform linux/arm64 redis:6-alpine
          docker pull --platform linux/arm64 nginx:latest
          docker pull --platform linux/arm64 ubuntu/squid:latest
          docker pull --platform linux/arm64 busybox:latest
          docker pull --platform linux/arm64 semitechnologies/weaviate:1.27.0

      - name: Save to Tar
        run: |
          docker save -o dify_arm64_bundle.tar \
            langgenius/dify-api:1.11.4 \
            langgenius/dify-web:1.11.4 \
            langgenius/dify-sandbox:0.2.12 \
            langgenius/dify-plugin-daemon:0.0.1 \
            postgres:15-alpine \
            redis:6-alpine \
            nginx:latest \
            ubuntu/squid:latest \
            busybox:latest \
            semitechnologies/weaviate:1.27.0
